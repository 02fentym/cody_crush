<form method="POST"
      hx-post="{% url 'upload-questions' %}"
      hx-target="#modal-body"
      hx-swap="innerHTML"
      enctype="multipart/form-data"
      hx-on="htmx:afterSwap: if (!document.querySelector('.text-error')) document.getElementById('modal-wrapper').checked = false"
      class="space-y-4">

    {% csrf_token %}

    <h3 class="font-bold text-lg mb-2">Upload Questions (CSV)</h3>

    <!-- Topic Dropdown -->
    <div class="form-control">
        <label class="label" for="topic_id">Select Topic</label>
        <select
            name="topic_id"
            id="topic_id"
            class="select select-bordered w-full"
            required
        >
            {% for topic in topics %}
            <option value="{{ topic.id }}">
                {{ topic.unit.title }} → {{ topic.title }}
            </option>
            {% endfor %}
        </select>
    </div>

    <!-- Question Type Dropdown -->
    <div class="form-control">
        <label class="label" for="question_type">Question Type</label>
        <select
            name="question_type"
            id="question_type"
            class="select select-bordered w-full"
            required
        >
            <option value="multiple_choice" selected>Multiple Choice</option>
            <option value="tracing">Tracing</option>
        </select>
    </div>

    <!-- File Upload -->
    <div class="form-control">
        <label class="label" for="file">CSV File</label>
        <input
            type="file"
            name="file"
            accept=".csv"
            class="btn btn-primary w-full flex items-center justify-center cursor-pointer h-10"
            style="line-height: 2.5rem"
            required
        />
    </div>

    <!-- Action Buttons -->
    <div class="modal-action">
        <button type="submit" class="btn btn-primary">Upload</button>
        <label for="modal-wrapper" class="btn">Cancel</label>
    </div>

    <!-- Error Display -->
    {% if errors %}
    <div class="text-error text-sm">
        <ul class="mt-2 space-y-1">
            {% for error in errors %}
            <li>❌ {{ error }}</li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}
</form>
